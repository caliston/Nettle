# linux crossbuild gcc / NetLib Makefile for Nettle
# (C) Nettle developers 2000-2001
#
# $Id$

ifeq (${LIB},scl)
LIBFLAGS   = -mlibscl -I$(NETLIB)
EXTRALIBS  = $(NETLIB)/o/NetLib,ffd
endif


CC = $(GCCDIR)/cross/bin/gcc
CFLAGS = -c -mapcs -Wall -Wno-unknown-pragmas -Wshadow -Wundef \
   -Wpointer-arith -Wcast-align -Wwrite-strings -Wstrict-prototypes \
   -Wmissing-prototypes -Wmissing-declarations -Wnested-externs \
   -Wcast-qual -DFORTIFY $(LIBFLAGS) -O2
# -mamu : generate !Depend file - only useful with AMU

LINK = $(CC)
LINKFLAGS = -debug $(LIBFLAGS) $(EXTRALIBS)

WIPE = rm
WIPEFLAGS = -rf

OBJASM = $(CC)
OBJASMFLAGS = -c

OBJS = chardefn.o choices.o globals.o init.o lineedit.o main.o misc.o \
       nettle.o process.o socket.o quit.o seln.o wimp.o zapgengc.o fortify.o

RUNIMAGE = !Nettle/!RunImage,ff8

all: $(RUNIMAGE)

$(RUNIMAGE): $(OBJS)
	@echo "### Linking $@..."
	@$(LINK) $(LINKFLAGS) $(OBJS) -o $@

clean:
	$(WIPE) $(WIPEFLAGS) *.o 

.SUFFIXES: .o .s .c

.s.o:
	@echo "### Assembling $<..."
	@$(OBJASM) $(OBJASMFLAGS) $< -o $@

.c.o:
	@echo "### Compiling $<..."
	@$(CC) $(CFLAGS) -o $@ $<


chardefn.o:	chardefn.c generic.h globals.h chardefn.h misc.h
choices.o:	choices.c generic.h globals.h choices.h misc.h
fortify.o:	fortify.c fortify.h ufortify.h
globals.o:	globals.c generic.h globals.h zapredraw.h
init.o: 	init.c generic.h globals.h chardefn.h init.h misc.h \
              	nettle.h quit.h wimp.h zapredraw.h
lineedit.o:   	lineedit.c generic.h globals.h lineedit.h misc.h wimp.h
main.o: 	main.c generic.h globals.h choices.h init.h main.h misc.h \
              	quit.h wimp.h
misc.o: 	misc.c generic.h globals.h misc.h
nettle.o:	nettle.h generic.h globals.h misc.h nettle.h seln.h socket.h \
	      	wimp.h zapredraw.h
process.o:	process.h generic.h globals.h graphics.h misc.h nettle.h \
		process.h seln.h wimp.h zapredraw.h
quit.o: 	quit.c generic.h globals.h misc.h nettle.h quit.h
seln.o: 	seln.c generic.h globals.h nettle.h seln.h wimp.h zapredraw.h
socket.o:	socket.c generic.h globals.h socket.h
wimp.o: 	wimp.c generic.h globals.h misc.h nettle.h process.h seln.h \
              	socket.h wimp.h zapredraw.h

