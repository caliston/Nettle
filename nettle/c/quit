/**
 * Closedown code
 * (C) Nettle developers 2000-2001
 *
 * $Id$
 */

#include "generic.h"
#include "globals.h"

#include "misc.h"
#include "nettle.h"
#include "quit.h"
#include "wimp.h"
#include "hotlist.h"

void closedown_application(void)
{
  /* Quit! */

  while (sessions)
  {
    remove_session(sessions);
  }

  _swi(MessageTrans_CloseFile, _IN(0), messagetrans_area);

  lose_bitmaps();
  lose_zapredraw_area();

  free(messagetrans_buffer);
  free(sprite_area);
  free(zap_font_area);
  free(zap_lowres_font_area);
  lose_hotlist();

  close_log(true);

#ifdef FORTIFY
  Fortify_LeaveScope();
#endif

  closedown_wimp();

  exit(EXIT_SUCCESS);
}
